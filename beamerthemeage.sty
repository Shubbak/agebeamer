\ProvidesPackage{beamerthemeage}[2023/12/19 Beamer theme for AG Ehresmann]

% Requirements
\RequirePackage{fontspec}
\RequirePackage[export]{adjustbox}
\RequirePackage{tikz}
\RequirePackage{overpic}

\mode<presentation>

% Define your theme colors
\definecolor{primary}{RGB}{199, 16, 92}  % Uni Kassel Hausfarbe HKS 28
\definecolor{secondary}{RGB}{218, 218, 218}  % Example: Define a secondary color
\definecolor{k80}{RGB}{87, 87, 87}
\definecolor{k50}{RGB}{157, 157, 157}
\definecolor{k20}{RGB}{218, 218, 218}
\definecolor{dunkelgr端n}{RGB}{21, 56, 36}
\definecolor{hellblau}{RGB}{80, 149, 200}
\definecolor{gelbgr端n}{RGB}{196, 210, 15}
\definecolor{hellgr端n}{RGB}{74, 172, 150}
\definecolor{goldgelb}{RGB}{234, 195, 114}
\definecolor{hks28}{RGB}{199, 16, 92}
\definecolor{hks28k30}{RGB}{154, 12, 70}

% Set the theme colors
\setbeamercolor{structure}{fg=primary}
\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=black}
\setbeamercolor{title}{fg=primary, bg=white}
\setbeamercolor{frametitle}{fg=primary}
\setbeamercolor{block title}{fg=primary}
\setbeamercolor{block body}{fg=black}
\setbeamercolor{alerted text}{fg=hellgr端n}
\setbeamercolor{footline}{fg=primary, bg=k20}

% Set font
\setmainfont{Arial}

% Define your theme fonts
\setbeamerfont{author}{size=\Large}
\setbeamerfont{title}{size=\huge, series=\bfseries}
\setbeamerfont{date}{size=\large, series=\bfseries}

\setbeamerfont{frametitle}{size=\huge, series=\bfseries}
\setbeamerfont{framenumber}{series=\bfseries}

\setbeamerfont{institute}{size=\large}
\setbeamerfont{section in head/foot}{size=\small}
\setbeamerfont{subsection in head/foot}{size=\small}

\setbeamerfont{item}{series=\bfseries}
\setbeamerfont{itemize/enumerate body}{size=\normalfont}
\setbeamerfont{itemize/enumerate subbody}{size=\normalfont}
\setbeamerfont{itemize/enumerate subsubbody}{size=\normalfont}

\setbeamerfont{block title}{series=\bfseries}
\setbeamerfont{section in toc}{series=\bfseries}

% Customize the headline
\setbeamertemplate{headline}{%
  \ifnum\insertframenumber=1%
  \else%
    \begin{overpic}[height=1.3cm]{logos/age.png}
      \begin{tikzpicture}[overlay, remember picture]
        \fill[k20] (0,0) -- (\paperwidth,0)--(\paperwidth,1.3)--(0,1.3)--cycle;
        \draw[line width=2pt, color=primary] (4.75,0) -- (4.75,1.3);
        \draw[line width=2pt, color=primary] (0,1pt) -- (12.75,1pt) -- (12.75,1.3);
        \draw[line width=4pt, color=primary] (4.75,1.3) -- (\paperwidth,1.3);
      \end{tikzpicture}
      \put(3,6){\includegraphics[height=11.5mm]{logos/unikassel.pdf}}
      \put(825,-5){\includegraphics[height=14.5mm]{logos/age.png}}
      \ifnum\value{section}>0%
        \put(537.5,55){\makebox(0,0){\textcolor{primary}{\small{\textbf{\insertshorttitle}}}}}
        \put(537.5,25){\makebox(0,0){\textcolor{primary}{\huge{\textbf{\insertsection}}}}}
      \else%
        \put(537.5,40){\makebox(0,0){\textcolor{primary}{\large{\textbf{\insertshorttitle}}}}}
      \fi%
    \end{overpic}
  \fi%
}

\setbeamertemplate{footline}{%
  \ifnum\insertframenumber=1%
  \else%
    \begin{overpic}[height=0.3cm]{logos/age.png}
      \begin{tikzpicture}[overlay, remember picture]
        \fill[k20] (0,0) -- (\paperwidth,0)--(\paperwidth,0.3)--(0,0.3)--cycle;
        \draw[line width=2pt, color=primary] (0,0.3) -- (\pagewidth,0.3);
      \end{tikzpicture}
      \put(5,15){\textcolor{primary}{\insertauthor} | \textcolor{primary}{\insertdate}}
      \put(4100,15){\textcolor{primary}{\insertframenumber} / \textcolor{primary}{\inserttotalframenumber}}
    \end{overpic}
  \fi%
}

% Customize the title page
\setbeamertemplate{title page}
{
  \ifx\inserttitlegraphic\empty%
  \else%
  \begin{beamercolorbox}[center, wd=\textwidth]{titlegraphic}
    \inserttitlegraphic%
  \end{beamercolorbox}%
  \vspace{10pt}%
  \fi%
  \ifx\inserttitle\empty\else%
  \begin{beamercolorbox}[center, wd=\textwidth]{title}
    \textcolor{secondary}{\rule{\textwidth}{1pt}}\\[0.5\baselineskip]%
    \usebeamerfont{title}\inserttitle
    \ifx\insertsubtitle\empty%
      \newline%
    \else%
      \\[0.5\baselineskip]%
      \usebeamerfont{subtitle}%
      \insertsubtitle\newline%
    \fi%
    \textcolor{secondary}{\rule{\textwidth}{1pt}}%
  \end{beamercolorbox}%
  \vspace{\fill}
  \fi%
  \ifx\insertauthor\empty%
  \else%
  \begin{beamercolorbox}[leftskip=0.2\textwidth, rightskip=0.2\textwidth, wd=\textwidth]{author}
    \centering\usebeamerfont{author}\insertauthor%
  \end{beamercolorbox}%
  \vspace{1ex}%
  \fi%
  \ifx\insertdate\empty%
  \else%
  \begin{beamercolorbox}[leftskip=0.2\textwidth, rightskip=0.2\textwidth, wd=\textwidth]{date}
    \centering\usebeamerfont{date}\insertdate%
  \end{beamercolorbox}%
  \vspace{1ex}%
  \fi%
  \ifx\insertinstitute\empty%
  \else%
  \begin{beamercolorbox}[leftskip=0.2\textwidth, rightskip=0.2\textwidth, wd=\textwidth]{institute}
    \centering\usebeamerfont{institute}\insertinstitute%
  \end{beamercolorbox}%
  \fi%
  \vspace{\fill}
}

% Customize the frame title
\setbeamertemplate{frametitle}{
  \vspace*{0.5cm}
  \usebeamerfont{frametitle}\insertframetitle\par
}

% Customize the block environment
\setbeamertemplate{blocks}[rounded][shadow=true]
\setbeamercolor{block title}{bg=secondary, fg=white}
\setbeamercolor{block body}{bg=white, fg=black}

% Add any additional customization you need

% End of your customizations